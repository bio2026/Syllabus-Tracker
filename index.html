<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syllabus Tracker | Exam Preparation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1527/1527666.png" type="image/png">

<style>
    :root {
        --primary: #4361ee;
        --secondary: #3a0ca3;
        --success: #4cc9f0;
        --light: #f8f9fa;
        --dark: #212529;
        --gray: #6c757d;
        --border: #dee2e6;
        --sidebar-width: 250px;
        --header-height: 60px;
        --transition-speed: 0.3s;
    }

    * { 
        margin: 0; 
        padding: 0; 
        box-sizing: border-box; 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        transition: all var(--transition-speed) ease-in-out;
    }

    body { 
        background-color: #f5f7fb; 
        color: var(--dark); 
        display: flex; 
        min-height: 100vh; 
    }

    /* Bangla font override */
    body:lang(bn), .bangla { 
        font-family: 'Hind Siliguri', sans-serif !important;
    }

    /* Sidebar */
    .sidebar { 
        width: var(--sidebar-width); 
        background: linear-gradient(to bottom, var(--primary), var(--secondary)); 
        color: white; 
        height: 100vh; 
        position: fixed; 
        overflow-y: auto; 
        padding: 20px 0; 
        box-shadow: 0 0 15px rgba(0,0,0,0.1); 
        z-index: 1000;
        transition: width var(--transition-speed) ease;
    }

    .sidebar-header { 
        padding: 0 20px 20px; 
        border-bottom: 1px solid rgba(255,255,255,0.1); 
        margin-bottom: 20px; 
    }

    .sidebar-header h2 { 
        font-size: 1.5rem; 
        display:flex; 
        align-items:center; 
        gap:10px; 
        animation: fadeInDown 0.6s ease;
    }

    .sidebar-menu { list-style: none; }
    .sidebar-menu li { margin-bottom: 5px; }
    .sidebar-menu a { 
        display:flex; 
        align-items:center; 
        padding:12px 20px; 
        color:white; 
        text-decoration:none; 
        transition: background-color var(--transition-speed), border-left var(--transition-speed); 
        border-left: 4px solid transparent; 
    }

    .sidebar-menu a:hover, 
    .sidebar-menu a.active { 
        background-color: rgba(255,255,255,0.1); 
        border-left: 4px solid var(--success); 
        transform: translateX(4px);
    }

    .sidebar-menu i { 
        margin-right: 10px; 
        font-size:1.2rem; 
        width:24px; 
        text-align:center; 
        transition: transform var(--transition-speed);
    }

    .sidebar-menu a:hover i { transform: rotate(10deg) scale(1.1); }

    /* Main Content */
    .main-content { 
        flex:1; 
        margin-left: var(--sidebar-width); 
        padding:30px; 
        transition: margin-left var(--transition-speed); 
    }

    .page-header { 
        margin-bottom:30px; 
        padding-bottom:15px; 
        border-bottom:1px solid var(--border); 
    }

    .page-header h1 { 
        font-size:1.8rem; 
        color:var(--primary); 
        animation: fadeInUp 0.6s ease;
    }

    /* Cards */
    .card { 
        background:white; 
        border-radius:10px; 
        box-shadow:0 5px 15px rgba(0,0,0,0.05); 
        margin-bottom:25px; 
        overflow:hidden; 
        transition: transform var(--transition-speed), box-shadow var(--transition-speed);
    }

    .card:hover { 
        transform: translateY(-5px); 
        box-shadow:0 10px 25px rgba(0,0,0,0.1); 
    }

    .card-header { 
        padding:15px 20px; 
        background-color: rgba(67,97,238,0.05); 
        border-bottom:1px solid var(--border); 
        font-weight:600; 
        color:var(--primary); 
        display:flex; 
        align-items:center; 
        justify-content:space-between; 
    }

    .card-body { padding:20px; }

    /* Progress */
    .progress-container { 
        display:grid; 
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
        gap:20px; 
    }

    .subject-progress { 
        padding:15px; 
        border-radius:8px; 
        background:white; 
        box-shadow:0 3px 10px rgba(0,0,0,0.05); 
        transition: transform var(--transition-speed);
    }

    .subject-progress:hover { transform: scale(1.02); }

    .subject-title { 
        display:flex; 
        justify-content:space-between; 
        margin-bottom:10px; 
        font-weight:600; 
        color:var(--dark); 
    }

    .progress-bar { 
        height:10px; 
        background-color:#e9ecef; 
        border-radius:5px; 
        overflow:hidden; 
        margin-bottom:5px; 
    }

    .progress-fill { 
        height:100%; 
        background-color:var(--success); 
        border-radius:5px; 
        transition: width 0.6s ease-in-out; 
    }

    .progress-text { 
        font-size:0.85rem; 
        color:var(--gray); 
        text-align:right; 
    }

    /* Chapter List */
    .chapters-list { list-style:none; }
    .chapter-item { 
        padding:12px 15px; 
        border-bottom:1px solid var(--border); 
        display:flex; 
        justify-content:space-between; 
        align-items:center; 
        transition: background-color var(--transition-speed);
    }

    .chapter-item:hover { background-color: rgba(67,97,238,0.05); }
    .chapter-item:last-child { border-bottom:none; }

    .mark-btn { 
        background-color:var(--primary); 
        color:white; 
        border:none; 
        padding:6px 12px; 
        border-radius:4px; 
        cursor:pointer; 
        font-size:0.85rem; 
        transition: background-color var(--transition-speed), transform var(--transition-speed); 
    }

    .mark-btn:hover { 
        background-color:var(--secondary); 
        transform: scale(1.05); 
    }

    .completed-badge { 
        background-color:var(--success); 
        color:white; 
        padding:4px 8px; 
        border-radius:4px; 
        font-size:0.75rem; 
        font-weight:500; 
        animation: fadeIn 0.4s ease; 
    }

    /* Modal */
    .modal { 
        display:none; 
        position:fixed; 
        top:0; 
        left:0; 
        width:100%; 
        height:100%; 
        background-color: rgba(0,0,0,0.5); 
        z-index:2000; 
        align-items:center; 
        justify-content:center; 
        animation: fadeIn 0.3s ease; 
    }

    .modal-content { 
        background-color:white; 
        padding:25px; 
        border-radius:10px; 
        width:90%; 
        max-width:400px; 
        box-shadow:0 5px 20px rgba(0,0,0,0.15); 
        animation: scaleUp 0.3s ease; 
    }

    .modal-header { margin-bottom:15px; color:var(--primary); font-size:1.2rem; }
    .modal-body { margin-bottom:20px; color:var(--dark); }
    .modal-footer { display:flex; justify-content:flex-end; gap:10px; }

    .modal-btn { 
        padding:8px 16px; 
        border-radius:4px; 
        cursor:pointer; 
        font-weight:500; 
        border:none; 
        transition: transform var(--transition-speed); 
    }

    .modal-btn:hover { transform: translateY(-2px); }
    .btn-confirm { background-color:var(--success); color:white; }
    .btn-cancel { background-color:#f8f9fa; color:var(--gray); border:1px solid var(--border); }

    /* Animations */
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    @keyframes fadeInUp { from { opacity:0; transform: translateY(20px);} to { opacity:1; transform: translateY(0);} }
    @keyframes fadeInDown { from { opacity:0; transform: translateY(-20px);} to { opacity:1; transform: translateY(0);} }
    @keyframes scaleUp { from { transform: scale(0.9);} to { transform: scale(1);} }

    /* Responsive */
    @media (max-width: 992px) { 
        .sidebar { width:70px; } 
        .sidebar-header h2 span, .sidebar-menu a span { display:none; } 
        .sidebar-menu i { margin-right:0; font-size:1.4rem; } 
        .main-content { margin-left:70px; } 
    }
    @media (max-width:768px) { 
        .progress-container { grid-template-columns: 1fr; } 
        .main-content { padding:20px; } 
    }
</style>

</head>
<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-book"></i> <span>Syllabus Tracker</span></h2>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" class="active" data-page="home"><i class="fas fa-home"></i> <span>Home</span></a></li>
            <li><a href="#" data-page="syllabus"><i class="fas fa-list-alt"></i> <span>Syllabus</span></a></li>
            <li><a href="#" data-page="completed"><i class="fas fa-check-circle"></i> <span>Completed</span></a></li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page -->
        <div id="home-page" class="page">
            <div class="page-header">
                <h1>Study Progress Overview</h1>
            </div>
            <div class="progress-container">
                <!-- Progress cards will be generated here -->
            </div>
        </div>

        <!-- Syllabus Page -->
        <div id="syllabus-page" class="page" style="display: none;">
            <div class="page-header">
                <h1>Full Syllabus</h1>
            </div>
            <div class="syllabus-container">
                <!-- Syllabus content will be generated here -->
            </div>
        </div>

        <!-- Completed Page -->
        <div id="completed-page" class="page" style="display: none;">
            <div class="page-header">
                <h1>Completed Chapters</h1>
            </div>
            <div class="completed-container">
                <!-- Completed content will be generated here -->
            </div>
        </div>
    </main>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmation-modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Completion</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure that you are almost prepared for exam on this chapter?</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-cancel">No</button>
                <button class="modal-btn btn-confirm">Yes</button>
            </div>
        </div>
    </div>

<script>
// ---------- Data ----------
const syllabusData = {
    "Physics Second Paper": [
        { chapter: "Chapter 1: তাপগতিবিদ্যা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 2: স্থির তড়িৎ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: চল তড়িৎ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 7: ভৌত আলোকবিজ্ঞান", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 8: আধুনিক পদার্থবিজ্ঞানের সূচনা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 11: জ্যোতির্বিজ্ঞান", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Chemistry Second Paper": [
        { chapter: "Chapter 1: পরিবেশ রসায়ন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 2: জৈব যৌগ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: পরিমাণগত রসায়ন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: তড়িৎ রসায়ন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Mathematics Second Paper": [
        { chapter: "Chapter 1: বাস্তব সংখ্যা ও অসমতা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: জটিল সংখ্যা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: বহুপদী ও বহুপদী সমীকরণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 6: কনিক", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 7: বিপরীত ত্রিকোণমিতিক ফাংশন ও ত্রিককোনমিতিক সমীকরণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 8: স্থিতিবিদ্যা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Biology First Paper": [
        { chapter: "Chapter 2: কোষ বিভাজন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 9: উদ্ভিদ শারীরতত্ত্ব", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 10: উদ্ভিদ প্রজনন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 11: জীবপ্রযুক্তি", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 12: জীবের পরিবেশ, বিস্তার ও সংরক্ষণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Biology Second Paper": [
        { chapter: "Chapter 2: প্রাণীর পরিচিতি (ঘাসফড়িং)", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: পরিপাক ও শোষণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: রক্ত ও রক্ত সংবহন", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 9: মানবজীবনের ধারাবাহিকতা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 12: প্রাণীর আচরণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "English Second Paper": [
        { chapter: "Chapter 1: Articles", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 2: Prepositions", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: Special Use of Some Phrases/Words", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: Clauses and Phrases", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 5: Right Form of Verbs", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 6: Changing Sentences", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 7: Narration", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 8: Pronoun Referencing", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 9: Modifiers", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 10: Sentence Connectors", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 11: Synonyms and Antonyms", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 12: Punctuation", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 13: Writing Part", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Bengali Second Paper": [
        { chapter: "Chapter 1: উচ্চারণ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 2: বানান", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: ব্যাকরণিক শব্দশ্রেণি", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: সমাস", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 5: বাক্যতত্ত্ব", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 6: বাংলা ভাষার অপপ্রয়োগ ও শুদ্ধ প্রয়োগ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 7: পারিভাষিক শব্দ", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 8: নির্মিতি", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ],
    "Information and Communication Technology": [
        { chapter: "Chapter 1: তথ্য ও যোগাযোগ প্রযুক্তি: বিশ্ব ও বাংলাদেশ প্রেক্ষিত", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 2: কমিউনিকেশন সিস্টেম ও নেটওয়ার্কিং", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 3: সংখ্যা পদ্ধতি ও ডিজিটাল ডিভাইস", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 4: ওয়েব ডিজাইন পরিচিতি ও HTML", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 5: প্রোগ্রামিং ভাষা", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] },
        { chapter: "Chapter 6: ডেটাবেজ ম্যানেজমেন্ট সিস্টেম", parts: ["মূলবই","জ্ঞানমূলক","অনুধাবনমূলক","সৃজনশীল"] }
    ]
};


// ---------- Storage Helpers ----------
function loadCompletedChapters() {
    try {
        const raw = localStorage.getItem('completedChapters');
        return raw ? JSON.parse(raw) : {};
    } catch (err) {
        console.warn("Could not parse saved progress", err);
        return {};
    }
}
function saveCompletedChapters() {
    localStorage.setItem('completedChapters', JSON.stringify(completedChapters));
}
let completedChapters = loadCompletedChapters();

// ---------- Initialization ----------
document.addEventListener("DOMContentLoaded", () => {
    initializeNavigation();
    renderHomePage();
    renderSyllabusPage();
    renderCompletedPage();
    setupModal();
    attachSyllabusDelegation();
});

// ---------- Navigation ----------
function initializeNavigation() {
    const navLinks = document.querySelectorAll('.sidebar-menu a');
    navLinks.forEach(link => {
        link.addEventListener("click", function(e) {
            e.preventDefault();
            const page = this.dataset.page;
            navLinks.forEach(l => l.classList.remove("active"));
            this.classList.add("active");

            document.querySelectorAll(".page").forEach(p => p.style.display = "none");
            document.getElementById(`${page}-page`).style.display = "block";

            if (page === "home") renderHomePage();
            if (page === "syllabus") renderSyllabusPage();
            if (page === "completed") renderCompletedPage();
        });
    });
}

// ---------- Rendering ----------
function renderHomePage() {
    const container = document.querySelector(".progress-container");
    container.innerHTML = "";

    for (const subject in syllabusData) {
        let totalParts = 0, completedCount = 0;
        syllabusData[subject].forEach(chap => {
            totalParts += chap.parts.length;
            if (completedChapters[subject]?.[chap.chapter]) {
                completedCount += completedChapters[subject][chap.chapter].length;
            }
        });
        const percent = totalParts ? Math.round((completedCount / totalParts) * 100) : 0;

        const card = document.createElement("div");
        card.className = "subject-progress card";
        card.innerHTML = `
            <div class="subject-title">
                <span>${escapeHtml(subject)}</span>
                <span>${percent}%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width:${percent}%;"></div>
            </div>
            <div class="progress-text">${completedCount} of ${totalParts} parts completed</div>
        `;
        container.appendChild(card);
    }
}

function renderSyllabusPage() {
    const container = document.querySelector(".syllabus-container");
    container.innerHTML = "";

    for (const subject in syllabusData) {
        let chaptersHTML = "";
        syllabusData[subject].forEach(chap => {
            chap.parts.forEach(part => {
                const isCompleted = completedChapters[subject]?.[chap.chapter]?.includes(part);
                chaptersHTML += `
                    <li class="chapter-item">
                        <span>${escapeHtml(chap.chapter)} - ${part}</span>
                        ${isCompleted 
                            ? '<span class="completed-badge">Completed</span>' 
                            : `<button class="mark-btn" data-subject="${escapeHtmlAttr(subject)}" data-chapter="${escapeHtmlAttr(chap.chapter)}" data-part="${escapeHtmlAttr(part)}">Mark as completed</button>`}
                    </li>`;
            });
        });

        const card = document.createElement("div");
        card.className = "card subject-container";
        card.innerHTML = `
            <div class="card-header">
                <div><i class="fas fa-book"></i> ${escapeHtml(subject)}</div>
            </div>
            <div class="card-body">
                <ul class="chapters-list">${chaptersHTML}</ul>
            </div>
        `;
        container.appendChild(card);
    }
}

function renderCompletedPage() {
    const container = document.querySelector(".completed-container");
    container.innerHTML = "";
    let hasCompleted = false;

    for (const subject in completedChapters) {
        let chaptersHTML = "";
        for (const chap in completedChapters[subject]) {
            completedChapters[subject][chap].forEach(part => {
                hasCompleted = true;
                chaptersHTML += `
                    <li class="chapter-item">
                        <span>${escapeHtml(chap)} - ${part}</span>
                        <span class="completed-badge">Completed</span>
                    </li>`;
            });
        }

        if (chaptersHTML) {
            const card = document.createElement("div");
            card.className = "card subject-container";
            card.innerHTML = `
                <div class="card-header">
                    <div><i class="fas fa-book"></i> ${escapeHtml(subject)}</div>
                </div>
                <div class="card-body">
                    <ul class="chapters-list">${chaptersHTML}</ul>
                </div>
            `;
            container.appendChild(card);
        }
    }

    if (!hasCompleted) {
        container.innerHTML = `
            <div class="card">
                <div class="card-body" style="text-align:center; padding:40px;">
                    <i class="fas fa-inbox" style="font-size:3rem; color:#dee2e6;"></i>
                    <h3 style="color:#6c757d;">No completed parts yet</h3>
                    <p>Start marking parts as completed from the Syllabus page</p>
                </div>
            </div>
        `;
    }
}

// ---------- Modal ----------
function setupModal() {
    const modal = document.getElementById("confirmation-modal");
    const cancelBtn = modal.querySelector(".btn-cancel");
    const confirmBtn = modal.querySelector(".btn-confirm");

    cancelBtn.addEventListener("click", () => closeModal());
    window.addEventListener("click", e => { if (e.target === modal) closeModal(); });
    window.addEventListener("keydown", e => { if (e.key === "Escape") closeModal(); });

    function closeModal() {
        modal.style.display = "none";
        confirmBtn.onclick = null;
    }
}
function showConfirmationModal(subject, chapter, part) {
    const modal = document.getElementById("confirmation-modal");
    const confirmBtn = modal.querySelector(".btn-confirm");
    confirmBtn.onclick = () => {
        markChapterAsCompleted(subject, chapter, part);
        modal.style.display = "none";
    };
    modal.style.display = "flex";
}

// ---------- Marking ----------
function markChapterAsCompleted(subject, chapter, part) {
    if (!completedChapters[subject]) completedChapters[subject] = {};
    if (!completedChapters[subject][chapter]) completedChapters[subject][chapter] = [];
    if (!completedChapters[subject][chapter].includes(part)) {
        completedChapters[subject][chapter].push(part);
        saveCompletedChapters();
        renderHomePage();
        renderSyllabusPage();
        renderCompletedPage();
    }
}

// ---------- Delegation ----------
function attachSyllabusDelegation() {
    const container = document.querySelector(".syllabus-container");
    container.addEventListener("click", e => {
        const btn = e.target.closest(".mark-btn");
        if (!btn) return;
        const subject = btn.dataset.subject;
        const chapter = btn.dataset.chapter;
        const part = btn.dataset.part;
        showConfirmationModal(subject, chapter, part);
    });
}

// ---------- Utilities ----------
function escapeHtml(str) {
    return String(str).replace(/[&<>\"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[s]));
}
function escapeHtmlAttr(str) { return escapeHtml(str).replace(/"/g, '&quot;'); }

</script>
</body>
</html>
